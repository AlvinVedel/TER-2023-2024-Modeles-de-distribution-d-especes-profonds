<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spiral Matrix Visualization</title>
    <style>
        .cell {
            fill: black;
            stroke: white;
        }
        .red-cell {
            fill: red;
            stroke: white;
        }
        .text {
            font-family: Arial, sans-serif;
            font-size: 6px;
            fill: white;
            pointer-events: none;
        }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <svg id="visualization" width="800" height="800"></svg>

    <script>
        // Taille de la matrice carrée
        var size = 77;
        var nbtot = 26500;

        // Taille des cellules
        var cellSize = 3;

        // Position de la cellule à mettre en rouge
        var redCellX = 38; // Position centrée pour une matrice de 77x77
        var redCellY = 38; // Position centrée pour une matrice de 77x77

        // Création de la visualisation
        var svg = d3.select("#visualization");

        var x = 395;
        var y = 395;
        var pas =0; 
        var direction = 1;
        var i =1;

        svg.append("rect")
            .attr("class", "cell")
            .attr("id", 0)
            .attr("x", 405)
            .attr("y", y)
            .attr("width", cellSize)
            .attr("height", cellSize);
        svg.append("text")
            .attr("class", "text")
            .attr("x", 405 + cellSize / 2)
            .attr("y", y + cellSize / 2)
            .attr("text-anchor", "middle")
            .attr("alignment-baseline", "middle")
            .text(0);

        x+=10

        while( i < nbtot){
            for(var k = 0; k < 2;k++){
                for(var j = 0; j <= pas;j++){
                    if(direction == 1){
                        x += 10;
                    }
                    else if(direction == 2){
                        y -= 10;
                    }
                    else if(direction == 3){
                        x -= 10;
                    }
                    else if(direction == 4){
                        y += 10;
                    }
                    svg.append("rect")
                        .attr("class", "cell")
                        .attr("id", i)
                        .attr("x", x)
                        .attr("y", y)
                        .attr("width", cellSize)
                        .attr("height", cellSize);
                    svg.append("text")
                        .attr("class", "text")
                        .attr("x", x + cellSize / 2)
                        .attr("y", y + cellSize / 2)
                        .attr("text-anchor", "middle")
                        .attr("alignment-baseline", "middle")
                        .text(i);
                    i+=1;

                    if(j == pas){
                        if(direction < 4 ){
                            direction +=1
                        }
                        else{
                            direction = 1
                        }
                    }
                      
                }
            }
            pas += 1; 
        }









        /*
        // Fonction pour calculer les coordonnées de la cellule en fonction de l'index
        function calculateCoordinates(index) {
            // Coordonnées du centre de la matrice
            var centerX = 39;
            var centerY = 39;

            // Initialisation des coordonnées
            var x = centerX;
            var y = centerY;

            // Calcul de l'indice spiralé
            var k = Math.ceil((Math.sqrt(index + 1) - 1) / 2);
            var t = 2 * k + 1;
            var m = Math.pow(t, 2);
            t -= 1;

            if (index >= m - t) {
                //console.log([x - (m - index - 1), y - k])
                return [x - (m - index - 1), y - k];
            } else {
                m -= t;
            }

            if (index >= m - t) {
                return [x - k, y - k + (m - index - 1)];
            } else {
                m -= t;
            }

            if (index >= m - t) {
                return [x - k + (m - index - 1), y + k];
            } else {
                console.log([x + k, y + k - (m - index - 1 - t)])
                return [x + k, y + k - (m - index - 1 - t)];
            }
        }

        // Génération de la matrice
        for (var i = 0; i < size * size; i++) {
            var coordinates = calculateCoordinates(i);
            var x = coordinates[0] * cellSize;
            var y = coordinates[1] * cellSize;
            var index = i; // Indice unique

            if (coordinates[0] === redCellX && coordinates[1] === redCellY) {
                svg.append("rect")
                    .attr("class", "red-cell")
                    .attr("id", index)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("width", cellSize)
                    .attr("height", cellSize);

                svg.append("text")
                    .attr("class", "text")
                    .attr("x", x + cellSize / 2)
                    .attr("y", y + cellSize / 2)
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "middle")
                    .text(index);
            } else {
                svg.append("rect")
                    .attr("class", "cell")
                    .attr("id", index)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("width", cellSize)
                    .attr("height", cellSize);

                svg.append("text")
                    .attr("class", "text")
                    .attr("x", x + cellSize / 2)
                    .attr("y", y + cellSize / 2)
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "middle")
                    .text(index);
            }
        }
*/
    </script>
</body>
</html>
